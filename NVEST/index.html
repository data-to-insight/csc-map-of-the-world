
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://data-to-insight.github.io/csc-map-of-the-world/NVEST/">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>NVEST Contacts Tool - CSC Map of the World</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/styles.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#nvest-toolscontacts-processing-regional-members-overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CSC Map of the World" class="md-header__button md-logo" aria-label="CSC Map of the World" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CSC Map of the World
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              NVEST Contacts Tool
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CSC Map of the World" class="md-nav__button md-logo" aria-label="CSC Map of the World" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    CSC Map of the World
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../network/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CSC Network
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CSC Search
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../sccm_relation_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CSC Relationships
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#contacts-processing-tool" class="md-nav__link">
    <span class="md-ellipsis">
      Contacts processing tool
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instructions" class="md-nav__link">
    <span class="md-ellipsis">
      Instructions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Instructions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step1-pre-processing-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Step1: Pre-processing steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step2-tool-processing-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Step2: Tool Processing steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step3-update-working-contacts-sheet" class="md-nav__link">
    <span class="md-ellipsis">
      Step3: Update working contacts sheet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#important-further-information" class="md-nav__link">
    <span class="md-ellipsis">
      Important further information
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nvest-events-files" class="md-nav__link">
    <span class="md-ellipsis">
      NVEST Events files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-tech-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Related Tech Notes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Related Tech Notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#process-logic" class="md-nav__link">
    <span class="md-ellipsis">
      Process Logic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#repo-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Repo structure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tech-stack" class="md-nav__link">
    <span class="md-ellipsis">
      Tech stack
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploymentdevelopment-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Deployment/Development notes
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="nvest-toolscontacts-processing-regional-members-overview">NVEST Tools(Contacts processing) &amp; Regional Members Overview</h1>
<p>In-progress collection of tools towards NVEST related processing.</p>
<p>Tool(s) available via : <a href="https://data-to-insight.github.io/nvest/">NVEST Tools</a></p>
<h2 id="contacts-processing-tool">Contacts processing tool</h2>
<p>A browser-based process for handling NVEST contacts and events data alongside a (quasi)live regional overview map. 
Uses <strong>stlite</strong> to run Streamlit/pyodide(in stlite) directly in browser and embeds both views via <code>&lt;iframe&gt;</code> containers into the html page(s). </p>
<hr />
<h2 id="instructions">Instructions</h2>
<h3 id="step1-pre-processing-steps">Step1: Pre-processing steps</h3>
<p>The master contacts worksheet. will only be up to date if the source data is. Confirm/do the following before running the contacts processing tool.</p>
<ol>
<li>Download the entire Wix NVEST EOI form submissions. The NVEST contacts, download should be accessed only via <a href="https://manage.wix.com/dashboard/af6cb463-8e72-4034-8f73-3641ad5abc9d/wix-forms-and-payments">Forms and Submissions</a>. Download this data into : <ul>
<li><code>NVEST/Contacts/NVEST_Contacts_Master_Processing/dddmmmyyy.csv</code></li>
</ul>
</li>
<li>If you have any contacts that have been sent seperately(i.e they might not have yet registered via Wix form), they should be added to the list in <ul>
<li><code>NVEST/Contacts/NVEST_Contacts_Master_Processing/contacts_other_external.csv</code> </li>
</ul>
</li>
<li>NVEST event/workshop invitations and attendance data is stored on event sheets within <ul>
<li><code>NVEST/Contacts/NVEST_Contacts_Master_Processing/Events/event1.csv + event2.csv + event3.csv + .....</code> </li>
</ul>
</li>
</ol>
<h3 id="step2-tool-processing-steps">Step2: Tool Processing steps</h3>
<p>Using <a href="https://data-to-insight.github.io/nvest/">NVEST Contacts Processing Tool</a></p>
<p><strong>There are 4 buttons/actions</strong>
  - Three for uploading the needed source contacts &amp; events data(in this order)</p>
<pre><code>1. Single file: `NVEST/Contacts/NVEST_Contacts_Master_Processing/&lt;wix_nvest_downloaded_contacts&gt;.csv`

2. Single file: `NVEST/Contacts/NVEST_Contacts_Master_Processing/contacts_other_external.csv`

3. **ALL**/Multiple-files in: `NVEST/Contacts/NVEST_Contacts_Master_Processing/Events/*.csv`
</code></pre>
<ul>
<li>
<p>One to download the resultant processed contacts data</p>
<ul>
<li>Data downloads as .csv file but MUST be saved/<strong>overwrite</strong> <code>NVEST/Contacts/NVEST_Contacts_Master_Processing/processed_contacts_refreshed.csv</code> </li>
</ul>
</li>
</ul>
<p><strong><em>The processing occurs immeadiately that the 3rd upload source files are added. There is nothing to press or do in order to initiate the actual processing and the download file is available instantly after the above 3 steps are completed.</em></strong></p>
<h3 id="step3-update-working-contacts-sheet">Step3: Update working contacts sheet</h3>
<p>Now that the contacts have been processed (i.e. cleaned, de-duped, other data added, steering grp flagged etc) and downloaded into <code>NVEST\Contacts\4 - contacts_processed\processed_contacts_refreshed.csv</code>. We are going to refresh the contacts sheet with this data. It's a simple 1 button update. </p>
<ul>
<li>Open the main Contacts Excel sheet/file on your PC. This is usually located: <code>NVEST\Contacts\</code> </li>
<li>From the ribbon, navigate to the 'Data' tab </li>
<li>Click 'Refresh All' from the 'Queries and Connections' block on the ribbon </li>
</ul>
<p>That's it. Whether you notice any changes or not, all the data in the contacts (and events) page(s) is now updated and current. </p>
<hr />
<h2 id="important-further-information">Important further information</h2>
<p><strong>NVEST_Contacts_Master.xls</strong>
The master contact sheet itself is NOT where contacts data should be edited/updated. The data sources within <code>\NVEST\Contacts\NVEST_Contacts_Master_Processing\</code> are where any changes/edits should be made. The reason is that we refresh all the data within the contacts workbook each time we run this process. So the source data and not the contacts workbook is our single data source for the actual contacts related data. IF wanting to store person/individual specific notes, or additional data against specific records, this can be done using a user defined lookup page in which email address, and those related additional columns/data is stored against them. </p>
<h2 id="nvest-events-files">NVEST Events files</h2>
<p>The NVEST events invites/attended are recorded to assist event planning and checking we've correctly contacted all those that have registered their interest. When a new event is planned, the full list of current Contacts emails should be copied from the master contact sheet overview (column <code>email</code>), and pasted afresh into into the next free <code>event1, 2, 3,... file</code>. <strong>Do not change the file name</strong>, or file type here as it will break the onward data flow. These are csv files so no formatting can be stored in the file. Instead, if desired such formatting can be added in the NVEST_Contacts_Master.xls.... in this file Event1, 2, 3 heading CAN then be changed to reflect the date or another decriptor for each event. To be clear.... col headers can only be modified in the NVEST_Contacts_Master.xls file. </p>
<p><strong>Key take-aways for managing events files</strong></p>
<ul>
<li>Events files cant be renamed</li>
<li>Events files are csv so not for annotating with colour formatting</li>
<li>Additional columns CAN be added into Events files - but those will NOT come through into the master contacts</li>
<li>New individual emails can be added to Event file at any point (but those emails/contacts should already exist in Wix OR contacts_other_external.csv)</li>
</ul>
<h2 id="related-tech-notes">Related Tech Notes</h2>
<h3 id="process-logic">Process Logic</h3>
<ol>
<li><strong>Upload</strong> CSVs:</li>
<li><em>Wix signups:</em><br />
<code>NVEST/Contacts/NVEST_Contacts_Master_Processing/&lt;latest date file&gt;.csv</code></li>
<li><em>Other external contacts:</em><br />
<code>NVEST/Contacts/NVEST_Contacts_Master_Processing/contacts_other_external.csv</code></li>
<li><em>NVEST events attendees:</em><br />
<code>NVEST/Contacts/NVEST_Contacts_Master_Processing/Events/&lt;upload &lt;ALL&gt; files in this folder&gt;.csv</code></li>
<li><strong>Clean + de-duplicate</strong> each:</li>
<li>Drop blanks, rename/standardise columns </li>
<li>Parse <code>submission_date</code> (empty dates get today())</li>
<li>Normalise/lower <code>email</code> </li>
<li>Keep latest record by <code>email</code> (web sign up record takes priority if duplicates identified)</li>
<li>We need to remove dups before merge, as might not have submission date/time on external records - so determining most recent record not possible; so we assume web sign up is more recent as members directed to this input route after having shown interest via another route, e.g. workshop.</li>
<li>Ensure column order matches requested output order </li>
<li>Apply basic text normalisation on agreed columns (currently: titlecase on <code>name</code>(not yet effective for such as McGregor), <code>role</code>, <code>local_authority</code>) </li>
<li>Sort on <code>name</code> (asc)       </li>
<li><strong>Added fields</strong>:</li>
<li><code>domain</code> (captured from email address - as this will be more reliable|consistent than inputted LA name text)  </li>
<li><code>steering_grp</code> (default: <code>"N"</code>)  </li>
<li>
<p><code>source</code>: <code>"Web"</code> for Wix, <code>"External"</code> for others (these labels explain where the contact has originated)</p>
</li>
<li>
<p><strong>Merge contacts datasets</strong></p>
</li>
<li>Bring together Wix contacts, and those coming in from other sources(e.g. via email, or requested)</li>
<li>Should a contact be added into the other sources, but later register via the web site the de-dup process will retain the web site registered record</li>
<li><strong>Flag steering group</strong> uses hard-coded email match (repo needs to stay private, as those emails now in code not upload via file)</li>
<li><strong>Preview rows</strong>, &amp; option of timestamped CSV download</li>
</ol>
<hr />
<h2 id="repo-structure">Repo structure</h2>
<ul>
<li><code>index.html</code>:<br />
  Landing page, currently with: </li>
<li>Left: <code>upload_tool.html</code> (iframe)  </li>
<li>
<p>Right: Embedded Google Map (iframe) </p>
</li>
<li>
<p><code>upload_tool.html</code>:<br />
  HTML file embedding a stlite-powered Streamlit app</p>
</li>
<li>
<p><code>assets/</code>:<br />
  Img assets (e.g., <code>images/d2i_logo.png</code>)
  Styling assets (e.g., <code>css/styles.css</code>)</p>
</li>
</ul>
<hr />
<h2 id="tech-stack">Tech stack</h2>
<ul>
<li><a href="https://streamlit.io">Streamlit</a> for data interface  </li>
<li><a href="https://github.com/whitphx/stlite">stlite</a> to run Streamlit app directly in browser (WebAssembly + Pyodide)  </li>
<li><a href="https://getbootstrap.com">Bootstrap 5</a> for layout  </li>
<li><a href="https://www.google.com/mymaps">Google My Maps</a> for embedded regional visual</li>
</ul>
<hr />
<h2 id="deploymentdevelopment-notes">Deployment/Development notes</h2>
<p>Built to run in <strong>GitHub Pages</strong> and other static hosting providers. Ensure:</p>
<ul>
<li>avoid direct browser refresh on subpages (e.g., <code>/upload_tool.html</code>) unless served (e.g., via iframe or root-relative path) - i've not added # or 404 handling</li>
<li>Test : python3 -m http.server 8501</li>
</ul>
<hr />







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="https://unpkg.com/cytoscape@3.24.0/dist/cytoscape.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
      
        <script src="../js/render_graph.js"></script>
      
        <script src="../js/search_tool.js"></script>
      
    
  </body>
</html>